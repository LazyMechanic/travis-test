language: cpp

matrix:
  fast_finish: true
  include:
    - os: linux
      compiler: gcc
      env:
        - MATRIX_EVAL="CC=gcc-9 && CXX=g++-9"
      before_install: 
        - eval "${MATRIX_EVAL}"
        - sudo apt-get -qq update
        - sudo apt-get install -y libgtest-dev cmake
        - cd /usr/src/gtest
        - sudo mkdir install 
        - sudo mkdir build 
        - cd build
        - sudo cmake .. -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX="/usr/src/gtest/install"
        - sudo cmake --build .
        - sudo cmake --install .
        - sudo cmake .. -DCMAKE_BUILD_TYPE=Debug -DCMAKE_INSTALL_PREFIX="/usr/src/gtest/install"
        - sudo cmake --build .
        - sudo cmake --install .
        - cd "${TRAVIS_BUILD_DIR}"
      before_script:
        - sudo mkdir build
        - cd build
      script:
        - sudo cmake ../CMakeLists.txt -Dtravis-test_BUILD_TESTS -DGtest_DIR="/usr/src/gtest/install/lib/cmake/GTest"
        - sudo cmake --build .
        - ctest

addons:
  apt:
    sources:
      - ubuntu-toolchain-r-test
      - llvm-toolchain-trusty
    packages:
      - g++-9
      - gcc-9
      - clang-9
      - cmake

notifications:
  recipients:
    - asharnrus.info@gmail.com
  email:
    on_success: never
    on_failure: change